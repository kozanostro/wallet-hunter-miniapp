<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Кабинет</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../css/main.css">
</head>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
  const tg = window.Telegram?.WebApp;

  function sendTest() {
    if (!tg) {
      alert("Telegram.WebApp НЕ найден. Ты открыл не из Telegram?");
      return;
    }

    tg.ready();

    const payload = {
      app: "WalletHunter",
      action: "test_send",
      user_id: tg.initDataUnsafe?.user?.id ?? null,
      ts: Date.now()
    };

    tg.sendData(JSON.stringify(payload));
    tg.showAlert("Отправил данные в бот ✅"); // чтобы ты видел, что sendData вызвался
  }
</script>

<button onclick="sendTest()" style="margin-top:16px;">
  ✅ SEND TEST (в бот)
</button>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
  function sendTestData() {
    const tg = window.Telegram?.WebApp;
    if (!tg) {
      alert("Telegram.WebApp не найден — ты открыл не из Telegram.");
      return;
    }

    tg.ready();

    const payload = {
      app: "WalletHunter",
      action: "test_send",
      user_id: tg.initDataUnsafe?.user?.id ?? null,
      ts: Date.now()
    };

    tg.sendData(JSON.stringify(payload));

    // Задержка — чтобы Telegram успел доставить данные
    setTimeout(() => tg.close(), 200);
  }
</script>

<button onclick="sendTestData()">✅ SEND TEST (в бот)</button>
    

<body>

<h2>Личный кабинет</h2>

<div id="profile"></div>

<button onclick="startHunt()">Начать</button>

<script>
    const user = JSON.parse(localStorage.getItem('tg_user'));

    document.getElementById('profile').innerHTML = `
        <p>ID: ${user.id}</p>
        <p>Ник: ${user.username || '-'}</p>
        <p>Время в игре: <span id="time">0</span> мин</p>
    `;

    let minutes = Number(localStorage.getItem('minutes') || 0);

    setInterval(() => {
        minutes++;
        localStorage.setItem('minutes', minutes);
        document.getElementById('time').innerText = minutes;
    }, 60000);

    function startHunt() {
        window.location.href = 'hunt.html';
    }
</script>

</body>
</html>

